{% extends "base.html" %}

{% block content %}
  {{ super() }}

  <hr>

  {% if page.meta.author %}
    <div class="page-authors">
      本页作者：
      {% set authors = page.meta.author.split(',') %}
      {% for author in authors %}
        <a href="https://github.com/{{ author.strip() }}" target="_blank">
          {{ author.strip() }}
        </a>{% if not loop.last %}, {% endif %}
      {% endfor %}
    </div>
  {% endif %}

  <div class="page-license">
    若未特别说明，本站使用 SATA 与 CC BY-NC-SA 4.0。
  </div>

  <div id="gitalk-container"></div>
  <script src="https://giscus.app/client.js"
        data-repo="CB-X2-Jun/codeforces-problems-cn-translations"
        data-repo-id="R_kgDORNrtjg"
        data-category="Announcements"
        data-category-id="DIC_kwDORNrtjs4C2Rv6"
        data-mapping="pathname"
        data-strict="1"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="top"
        data-theme="light_tritanopia"
        data-lang="zh-CN"
        crossorigin="anonymous"
        async>
</script>

<script>
  function getGiscusTheme() {
    const meta = document.querySelector('meta[name="color-scheme"]');
    if (!meta) return "light_tritanopia";

    return meta.getAttribute("content") === "dark"
      ? "dark_dimmed"
      : "light_tritanopia";
  }

  function syncGiscusTheme() {
    const iframe = document.querySelector("iframe.giscus-frame");
    if (!iframe) return;

    iframe.contentWindow.postMessage(
      {
        giscus: {
          setConfig: {
            theme: getGiscusTheme()
          }
        }
      },
      "https://giscus.app"
    );
  }

  // 页面加载后同步一次
  window.addEventListener("load", () => {
    setTimeout(syncGiscusTheme, 300);
  });

  // 监听 <meta name="color-scheme"> 变化
  const meta = document.querySelector('meta[name="color-scheme"]');
  if (meta) {
    const observer = new MutationObserver(syncGiscusTheme);
    observer.observe(meta, {
      attributes: true,
      attributeFilter: ["content"]
    });
  }
</script>


      <!-- <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
      <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
      <script>
        var gitalk = new Gitalk({
  clientID: 'Ov23li4CqXkddudm4GQW',
  clientSecret: '3f27ba1e2e41b3bf71e6a5f0cb2c90e8d089f0aa',
  repo: 'codeforces-problems-cn-translations',
  owner: 'CB-X2-Jun',
  admin: ['CB-X2-Jun'],
  id: location.pathname,      // Ensure uniqueness and length less than 50
  distractionFreeMode: true,  // Facebook-like distraction free mode
  perPage: 50,
  pagerDirection: 'first',
  labels: ['Created by Gitalk', 'Comments']
})

gitalk.render('gitalk-container')
      </script> -->

{% endblock %}
